@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer localizer
@inject BCKFreightTMS.Services.Data.IApplicationTemplateService templateService
@inject BCKFreightTMS.Services.Data.ITemplatePlaceholderService placeholderService
@model BCKFreightTMS.Web.ViewModels.Orders.CarrierOrderApplicationModel
@{
    var template = await templateService.GetDefaultForCompanyAsync(this.Model.OrderCreatorCompany.Id);
    
    if (template != null)
    {
        // Use custom template with placeholder replacement
        var html = placeholderService.ReplacePlaceholders(template.HtmlTemplate, this.Model);
        var css = template.CssStyles;
        
        if (!string.IsNullOrEmpty(css))
        {
            <style>
                @Html.Raw(css)
            </style>
        }
        
        @Html.Raw(html)
    }
    else
    {
        await Html.RenderPartialAsync("Orders/_DefaultApplicationTemplate", this.Model);
    }
}
